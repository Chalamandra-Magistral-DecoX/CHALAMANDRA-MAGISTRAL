<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Chalamandra Arcade SRAP: Metodolog√≠as creativas chola-fresa para mapear el flow y potenciar ideas.">
    <title>Chalamandra Arcade SRAP ULTRA</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;900&family=Bangers&family=Press+Start+2P&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --rosa: #ff4d9e;
            --verde: #00ff99;
            --purple: #9933ff;
            --naranja: #ff8500;
            --azul: #3399ff;
            --fondo: #0a0a0a;
            --card-bg: rgba(20, 20, 35, 0.85);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Montserrat', sans-serif;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            background: var(--fondo);
            color: #fff;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 10px;
            overflow-x: hidden;
            background-image: 
                radial-gradient(circle at 10% 10%, rgba(153, 51, 255, 0.1) 0%, transparent 40%),
                radial-gradient(circle at 90% 90%, rgba(255, 77, 158, 0.1) 0%, transparent 40%);
        }

        .container { width: 100%; max-width: 960px; }

        .stats-bar {
            width: 100%;
            background: rgba(0,0,0,0.9);
            padding: 12px 20px;
            border-radius: 15px;
            border: 1px solid var(--verde);
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-family: 'Press Start 2P', cursive;
            font-size: 0.65rem;
            color: var(--verde);
            box-shadow: 0 5px 15px rgba(0, 255, 153, 0.2);
        }

        header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px;
            background: var(--card-bg);
            border-radius: 30px;
            border: 1px solid rgba(255, 77, 158, 0.3);
            backdrop-filter: blur(10px);
        }

        header h1 {
            font-family: 'Bangers', cursive;
            color: var(--rosa);
            font-size: clamp(2.5rem, 8vw, 4.5rem);
            letter-spacing: 4px;
            text-shadow: 4px 4px 0px var(--purple);
            margin-bottom: 10px;
        }

        .arcade-badge {
            font-family: 'Press Start 2P', cursive;
            font-size: 0.6rem;
            color: #000;
            background: var(--verde);
            padding: 8px 15px;
            border-radius: 5px;
            display: inline-block;
            margin-bottom: 15px;
            animation: blink 1.5s infinite;
        }

        @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }

        .dice-section {
            background: var(--card-bg);
            padding: 40px 20px;
            border-radius: 30px;
            margin-bottom: 40px;
            text-align: center;
            border: 1px solid rgba(153, 51, 255, 0.3);
        }

        .scene { width: 150px; height: 150px; margin: 30px auto; perspective: 800px; }
        .dice {
            width: 100%; height: 100%; position: relative;
            transform-style: preserve-3d;
            transition: transform 2s cubic-bezier(0.17, 0.67, 0.14, 1.03);
            transform: rotateX(-20deg) rotateY(-20deg);
        }

        .dice-face {
            position: absolute; width: 150px; height: 150px;
            border: 3px solid rgba(255, 255, 255, 0.4);
            display: flex; justify-content: center; align-items: center;
            font-size: 3rem; border-radius: 20px; backface-visibility: hidden;
            box-shadow: inset 0 0 20px rgba(0,0,0,0.5);
        }

        .face-1 { transform: rotateY(0deg) translateZ(75px); background: var(--rosa); }
        .face-2 { transform: rotateY(180deg) translateZ(75px); background: var(--purple); }
        .face-3 { transform: rotateY(90deg) translateZ(75px); background: var(--verde); }
        .face-4 { transform: rotateY(-90deg) translateZ(75px); background: var(--azul); }
        .face-5 { transform: rotateX(90deg) translateZ(75px); background: var(--naranja); }
        .face-6 { transform: rotateX(-90deg) translateZ(75px); background: #333; }

        .btn-action {
            padding: 18px 40px; font-size: 1.2rem; font-weight: 900;
            background: linear-gradient(45deg, var(--rosa), var(--purple));
            color: white; border: none; border-radius: 100px; cursor: pointer;
            box-shadow: 0 10px 20px rgba(255, 77, 158, 0.4); transition: 0.3s;
            text-transform: uppercase; letter-spacing: 1px;
        }

        .btn-action:hover:not(:disabled) { transform: scale(1.05); filter: brightness(1.2); }
        .btn-action:disabled { opacity: 0.5; cursor: not-allowed; }

        .section-title {
            font-family: 'Bangers', cursive; font-size: 2.8rem; color: var(--verde);
            text-align: center; margin-bottom: 30px; text-shadow: 2px 2px 0px #000;
        }

        .game-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; }
        .game-card {
            background: var(--card-bg); border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 24px; padding: 30px; cursor: pointer;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            display: flex; flex-direction: column; gap: 15px;
        }

        .game-card:hover { border-color: var(--verde); transform: translateY(-10px); background: rgba(255, 255, 255, 0.08); }
        .game-card i { font-size: 2.5rem; color: var(--rosa); }
        .game-card h3 { font-family: 'Press Start 2P', cursive; font-size: 0.75rem; color: #fff; line-height: 1.4; }
        .game-card p { font-size: 0.95rem; color: #ccc; line-height: 1.5; }

        .overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.98); z-index: 2000; display: none;
            justify-content: center; align-items: center; padding: 20px; backdrop-filter: blur(15px);
        }

        .modal {
            background: #111122; width: 100%; max-width: 750px; border-radius: 35px;
            border: 2px solid var(--verde); padding: clamp(20px, 5vw, 40px);
            position: relative; max-height: 90vh; overflow-y: auto;
            box-shadow: 0 0 50px rgba(0, 255, 153, 0.3);
        }

        .close-btn { position: absolute; top: 25px; right: 25px; font-size: 2.2rem; color: var(--rosa); cursor: pointer; }

        /* --- Minigame Specific Styles --- */
        .pastel-grid { display: flex; flex-wrap: wrap; gap: 15px; justify-content: center; margin: 25px 0; }
        .slice {
            width: 100px; height: 100px; background: var(--purple); border-radius: 50% 50% 5px 50%;
            display: flex; justify-content: center; align-items: center; cursor: pointer;
            transition: 0.3s; font-weight: 800; text-align: center; border: 2px solid rgba(255,255,255,0.1);
        }
        .slice.done { opacity: 0.2; transform: scale(0.8); pointer-events: none; }

        #canvas-caos { background: #000; border: 2px solid #333; border-radius: 20px; display: block; margin: 20px auto; touch-action: none; max-width: 100%; }

        .inventory-box { display: grid; grid-template-columns: repeat(auto-fill, minmax(65px, 1fr)); gap: 10px; margin: 20px 0; }
        .slot {
            aspect-ratio: 1; background: rgba(255,255,255,0.05); border: 2px dashed #555;
            border-radius: 12px; display: flex; justify-content: center; align-items: center;
            font-size: 1.5rem; cursor: pointer;
        }
        .slot.equipped { border: 2px solid var(--verde); background: rgba(0, 255, 153, 0.2); }

        .soccer-field {
            background: linear-gradient(to bottom, #1b4d1b, #0e2b0e); height: 280px;
            border: 3px solid #fff; border-radius: 15px; position: relative; margin: 20px 0; overflow: hidden;
        }
        .player-idea {
            position: absolute; background: var(--rosa); padding: 6px 12px; border-radius: 6px;
            font-weight: bold; font-size: 0.75rem; cursor: move; box-shadow: 0 4px 10px rgba(0,0,0,0.5);
        }

        .flame-container { height: 80px; display: none; margin: 20px auto; }
        .flame {
            width: 40px; height: 60px; background: linear-gradient(to top, var(--naranja), var(--rosa));
            border-radius: 50% 50% 20% 20%; margin: 0 auto; filter: blur(4px);
            animation: burn 0.2s infinite alternate;
        }
        @keyframes burn { 0% { transform: scale(1); } 100% { transform: scale(1.2); } }

        textarea { width: 100%; background: rgba(0,0,0,0.3); border: 1px solid #444; border-radius: 15px; padding: 15px; color: #fff; margin-top: 15px; resize: none; transition: 1s; }
        textarea.burning { opacity: 0; transform: translateY(-20px); filter: blur(10px); }

        .choice-btn {
            background: rgba(255,255,255,0.05); border: 1px solid #444; padding: 12px;
            border-radius: 10px; text-align: left; cursor: pointer; color: #fff; width: 100%; margin-bottom: 8px;
        }

        footer { margin-top: 80px; padding: 40px; text-align: center; border-top: 1px solid rgba(255,255,255,0.1); color: #666; font-size: 0.85rem; }

        .glow { box-shadow: 0 0 15px var(--verde), 0 0 30px var(--verde); }
    </style>
</head>
<body>

    <div class="container">
        <div class="stats-bar">
            <span>STREET CRED: <span id="cred-count">0</span></span>
            <span id="rank-name">LVL: NOVATO</span>
        </div>

        <header>
            <div class="arcade-badge">PRO SRAP v3.0</div>
            <h1>CHALAMANDRA</h1>
            <p>Mapeando el flow creativo con sabidur√≠a callejera y glitch est√©tico.</p>
        </header>

        <section class="dice-section">
            <div class="scene">
                <div class="dice glow" id="main-dice" aria-hidden="true">
                    <div class="dice-face face-1">üéÇ</div>
                    <div class="dice-face face-2">üé©</div>
                    <div class="dice-face face-3">üéí</div>
                    <div class="dice-face face-4">üó∫Ô∏è</div>
                    <div class="dice-face face-5">‚öΩ</div>
                    <div class="dice-face face-6">‚ú®</div>
                </div>
            </div>
            <button class="btn-action glow" id="roll-btn"><i class="fas fa-bolt"></i> CHALAMANDRAZO</button>
            <div id="dice-result" style="margin-top:20px; font-weight:bold; color:var(--verde); height:1.5rem;"></div>
        </section>

        <main class="arcade-section">
            <h2 class="section-title">ZONA DE ARCADE</h2>
            <div class="game-grid">
                <article class="game-card glow" onclick="openGame(0)"><i class="fas fa-birthday-cake"></i><h3>EL PASTELOTE EMOCIONAL</h3><p>Libera emociones rebanada por rebanada.</p></article>
                <article class="game-card glow" onclick="openGame(1)"><i class="fas fa-hat-wizard"></i><h3>LOS 6 LOOKS DE LA TERCIA</h3><p>Cambia la perspectiva con outfits cognitivos.</p></article>
                <article class="game-card glow" onclick="openGame(2)"><i class="fas fa-suitcase"></i><h3>KIT DEL MALANDRO (INV)</h3><p>Equipa tus habilidades y herramientas.</p></article>
                <article class="game-card glow" onclick="openGame(3)"><i class="fas fa-spray-can"></i><h3>EL MAPA DEL CAOS (TAGGER)</h3><p>Traza tus rutas y zonas de peligro.</p></article>
                <article class="game-card glow" onclick="openGame(4)"><i class="fas fa-futbol"></i><h3>TERRENO DE IDEAS</h3><p>Planifica jugadas estrat√©gicas maestras.</p></article>
                <article class="game-card glow" onclick="openGame(5)"><i class="fas fa-fire-alt"></i><h3>EL ALTAR DE LO ROTO</h3><p>Ritual para transmutar h√°bitos caducos.</p></article>
                <article class="game-card glow" onclick="openGame(6)"><i class="fas fa-skull-crossbones"></i><h3>LABERINTO DE LA TRAMPA</h3><p>Encuentra tus llaves de autoconocimiento.</p></article>
            </div>
        </main>
    </div>

    <div class="overlay" id="overlay">
        <div class="modal" role="dialog" aria-modal="true">
            <span class="close-btn" onclick="closeGame()">&times;</span>
            <div id="modal-content"></div>
        </div>
    </div>

    <audio id="bg-music" src="https://cdn.pixabay.com/download/audio/2023/09/21/audio_6b932c9d3a.mp3?filename=arcade-loop-112bpm-10981.mp3" loop></audio>

    <script>
        // --- Game State ---
        let points = 0;
        const ranks = ["NOVATO", "BATO", "MALANDRO", "CRACK", "CHALA-MASTER", "DECODIFICADOR"];
        
        function updatePoints(p) {
            points += p;
            document.getElementById('cred-count').innerText = points;
            const rankIdx = Math.min(Math.floor(points / 150), ranks.length - 1);
            document.getElementById('rank-name').innerText = `LVL: ${ranks[rankIdx]}`;
        }

        // --- Dice Logic ---
        const dice = document.getElementById('main-dice');
        const rollBtn = document.getElementById('roll-btn');
        const resultText = document.getElementById('dice-result');
        const diceRotations = [{x:0,y:0}, {x:0,y:180}, {x:0,y:-90}, {x:0,y:90}, {x:-90,y:0}, {x:90,y:0}];
        const methodTitles = ["üéÇ Pastelote", "üé© 6 Looks", "üéí Kit Malandro", "üó∫Ô∏è Mapa Caos", "‚öΩ Terreno", "‚ú® Altar Roto"];

        rollBtn.addEventListener('click', () => {
            document.getElementById('bg-music').play().catch(() => {});
            let idx = Math.floor(Math.random() * 6);
            let target = diceRotations[idx];
            let extra = 1440;
            rollBtn.disabled = true;
            dice.style.transform = `rotateX(${target.x + extra}deg) rotateY(${target.y + extra}deg)`;
            resultText.innerText = "¬°D√ÅNDOLE...";
            setTimeout(() => {
                resultText.innerText = `¬°SORPRESA: ${methodTitles[idx]}!`;
                rollBtn.disabled = false;
                updatePoints(20);
                setTimeout(() => openGame(idx), 800);
            }, 2000);
        });

        // --- Game Data & Modal Logic ---
        const overlay = document.getElementById('overlay');
        const modalContent = document.getElementById('modal-content');

        const gameData = [
            {
                title: "TABLERO DEL PASTELOTE EMOCIONAL",
                intro: "Haz clic en cada rebanada para 'com√©rtela' y liberar la emoci√≥n.",
                html: `<div class="pastel-grid">
                    <div class="slice" onclick="eatSlice(this, 'Enojo')">üí¢<br>ENOJO</div>
                    <div class="slice" onclick="eatSlice(this, 'Ternura')">üß∏<br>TERNURA</div>
                    <div class="slice" onclick="eatSlice(this, 'Drama')">üò≠<br>DRAMA</div>
                    <div class="slice" onclick="eatSlice(this, 'Gozo')">‚ú®<br>GOZO</div>
                    <div class="slice" style="background:var(--verde); color:#000" onclick="eatSlice(this, 'Pastelazo')">ü§°<br>PASTELAZO</div>
                </div><textarea placeholder="¬øQu√© sientes al liberar este ciclo?"></textarea>`
            },
            {
                title: "LOS 6 LOOKS DE LA TERCIA",
                intro: "Selecciona un look mental para cambiar tu perspectiva actual.",
                html: `<div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px; margin:15px 0;">
                    <button class="choice-btn" onclick="lookInfo('Look Datos: Solo hechos reales.')">‚ö™ DATOS</button>
                    <button class="choice-btn" onclick="lookInfo('Look Drama: ¬°Suelta el sentimiento!')">üî¥ SENTIR</button>
                    <button class="choice-btn" onclick="lookInfo('Look Hater: ¬øQu√© va a fallar?')">‚ö´ CR√çTICA</button>
                    <button class="choice-btn" onclick="lookInfo('Look Optimista: ¬øQu√© ganamos?')">üü° BENEFICIO</button>
                </div><div id="look-out" style="padding:15px; background:rgba(255,255,255,0.05); border-radius:10px;">Elige un outfit mental...</div>`
            },
            {
                title: "KIT DEL MALANDRO (INVENTARIO)",
                intro: "Equipa tus herramientas para enfrentar el desaf√≠o de hoy.",
                html: `<div class="inventory-box">
                    <div class="slot" onclick="equip(this, 'üí£')"></div>
                    <div class="slot" onclick="equip(this, 'üï∂Ô∏è')"></div>
                    <div class="slot" onclick="equip(this, '‚ù§Ô∏è')"></div>
                    <div class="slot" onclick="equip(this, 'üî•')"></div>
                    <div class="slot" onclick="equip(this, 'üßø')"></div>
                    <div class="slot" onclick="equip(this, '‚ö°')"></div>
                </div>`
            },
            {
                title: "EL MAPA DEL CAOS (TAGGER)",
                intro: "Dibuja tus zonas: Rojo (Peligro), Verde (Seguro), Azul (Escape).",
                html: `<canvas id="canvas-caos" width="450" height="250"></canvas>
                <div style="display:flex; justify-content:center; gap:8px">
                    <button class="choice-btn" style="width:auto" onclick="setBrush('red')">ROJO</button>
                    <button class="choice-btn" style="width:auto" onclick="setBrush('#00ff99')">VERDE</button>
                    <button class="choice-btn" style="width:auto" onclick="setBrush('#3399ff')">AZUL</button>
                    <button class="choice-btn" style="width:auto" onclick="clearCanvas()">LIMPIAR</button>
                </div>`
            },
            {
                title: "EL TERRENO DE JUEGO DE IDEAS",
                intro: "Arrastra a tus 'jugadores' (ideas) para planear la estrategia ganadora.",
                html: `<div class="soccer-field" id="field">
                    <div class="player-idea" style="top:20%; left:40%" onmousedown="dragIdea(this, event)" ontouchstart="dragIdea(this, event)">SOLUCI√ìN</div>
                    <div class="player-idea" style="bottom:20%; left:20%; background:var(--azul)" onmousedown="dragIdea(this, event)" ontouchstart="dragIdea(this, event)">OBST√ÅCULO</div>
                    <div class="player-idea" style="top:45%; left:65%; background:var(--purple)" onmousedown="dragIdea(this, event)" ontouchstart="dragIdea(this, event)">CREATIVIDAD</div>
                </div>`
            },
            {
                title: "EL ALTAR DE LA HERRAMIENTA ROTA",
                intro: "Escribe lo que quieres soltar. Al encender la llama, se transmutar√°.",
                html: `<textarea id="burn-ta" placeholder="¬øQu√© quieres dejar ir?"></textarea>
                <div class="flame-container" id="f-box"><div class="flame"></div></div>
                <button class="btn-action" style="width:100%; margin-top:15px" onclick="burnProcess()">ENCENDER LLAMA</button>`
            },
            {
                title: "EL LABERINTO DE LA TRAMPA",
                intro: "Est√°s frente a un bloqueo mental. ¬øC√≥mo decides avanzar?",
                html: `<div id="maze-narrative" style="padding:15px; background:rgba(0,0,0,0.2); border-radius:15px; margin-bottom:15px">Muro detectado: PERFECCIONISMO.</div>
                <button class="choice-btn" onclick="mazeStep('Intentas saltarlo.', 'Muro muy alto. Necesitas la llave de la AUTENTICIDAD.')">Saltar</button>
                <button class="choice-btn" onclick="mazeStep('Buscas una grieta.', '¬°Encontraste la llave! La curiosidad te abre el paso.')">Explorar</button>`
            }
        ];

        function openGame(idx) {
            const data = gameData[idx];
            modalContent.innerHTML = `<h2 style="font-family:'Bangers';font-size:2.2rem;color:var(--rosa);margin-bottom:10px">${data.title}</h2><p style="color:#aaa;font-size:0.95rem">${data.intro}</p><div style="margin-top:20px">${data.html}</div>`;
            overlay.style.display = 'flex';
            if (idx === 3) initCanvas();
        }
        function closeGame() { overlay.style.display = 'none'; }

        // --- Handlers ---
        function eatSlice(el, t) { el.classList.add('done'); updatePoints(15); }
        function lookInfo(t) { document.getElementById('look-out').innerText = t; updatePoints(5); }
        function equip(el, i) { el.classList.toggle('equipped'); el.innerText = el.classList.contains('equipped') ? i : ''; updatePoints(10); }
        
        let paint = false, bColor = '#00ff99';
        function initCanvas() {
            const c = document.getElementById('canvas-caos'); if (!c) return;
            const ctx = c.getContext('2d');
            const start = (e) => { paint = true; draw(e); };
            const stop = () => { paint = false; ctx.beginPath(); };
            const draw = (e) => {
                if (!paint) return;
                const r = c.getBoundingClientRect();
                const x = (e.clientX || (e.touches && e.touches[0].clientX)) - r.left;
                const y = (e.clientY || (e.touches && e.touches[0].clientY)) - r.top;
                ctx.lineWidth = 5; ctx.lineCap = 'round'; ctx.strokeStyle = bColor;
                ctx.lineTo(x, y); ctx.stroke(); ctx.beginPath(); ctx.moveTo(x, y);
            };
            c.addEventListener('mousedown', start); c.addEventListener('mouseup', stop); c.addEventListener('mousemove', draw);
            c.addEventListener('touchstart', (e) => { e.preventDefault(); start(e); });
            c.addEventListener('touchend', stop); c.addEventListener('touchmove', (e) => { e.preventDefault(); draw(e); });
        }
        window.setBrush = (c) => bColor = c;
        window.clearCanvas = () => { const c = document.getElementById('canvas-caos'); c.getContext('2d').clearRect(0,0,450,250); };

        function dragIdea(el, e) {
            const isT = e.type === 'touchstart', mEv = isT ? 'touchmove' : 'mousemove', uEv = isT ? 'touchend' : 'mouseup';
            const f = document.getElementById('field');
            const onM = (mE) => {
                const r = f.getBoundingClientRect();
                const cX = isT ? mE.touches[0].clientX : mE.clientX, cY = isT ? mE.touches[0].clientY : mE.clientY;
                el.style.left = `${Math.max(0, Math.min(cX - r.left - 30, r.width - 60))}px`;
                el.style.top = `${Math.max(0, Math.min(cY - r.top - 15, r.height - 30))}px`;
            };
            document.addEventListener(mEv, onM);
            document.addEventListener(uEv, () => { document.removeEventListener(mEv, onM); updatePoints(5); }, {once:true});
        }

        function burnProcess() {
            const ta = document.getElementById('burn-ta'); if (!ta.value) return;
            document.getElementById('f-box').style.display = 'block';
            ta.classList.add('burning'); updatePoints(50);
            setTimeout(() => { alert("Transmutado. El peso se fue, el aprendizaje se queda."); closeGame(); }, 2500);
        }

        function mazeStep(c, r) { document.getElementById('maze-narrative').innerHTML = `<strong>${c}</strong><br>${r}`; updatePoints(20); }

        document.getElementById('bg-music').volume = 0.2;
    </script>
</body>
</html>
